this.ReactMVI=this.ReactMVI||{},this.ReactMVI.http=function(e,t,n){"use strict";function r(e){var t=[];return s(e,t),t.join("&")}function o(e){return p.call(e).match(a)[1]}function s(e,t,n){void 0===n&&(n="");var r=o(e);if("Object"===r)for(var i in e){var u=o(e[i]),a=(n?n+".":"")+i;"String"===u||"Number"===u||"RegExp"===u||"Boolean"===u?t.push(encodeURIComponent(a)+"="+encodeURIComponent(e[i])):"Date"===u?t.push(encodeURIComponent(a)+"="+encodeURIComponent(String(+e[i]))):"Object"===u?s(e[i],t,i):"Array"===u&&s(e[i],t,i)}else if("Array"===r)for(var p=0,c=e.length;p<c;p++)t.push(encodeURIComponent(n[p])+"="+encodeURIComponent(e[p]))}!function(e){e[e.GET=1]="GET",e[e.POST=2]="POST",e[e.PUT=3]="PUT",e[e.DELETE=4]="DELETE"}(e.HttpMethod||(e.HttpMethod={})),function(e){e[e.JSON=1]="JSON",e[e.BLOB=2]="BLOB",e[e.ARRAY_BUFFER=3]="ARRAY_BUFFER",e[e.FORM_DATA=4]="FORM_DATA",e[e.TEXT=5]="TEXT",e[e.STREAM=6]="STREAM"}(e.ResponseType||(e.ResponseType={})),function(e){e[e.PROGRESS=1]="PROGRESS",e[e.ERROR=2]="ERROR",e[e.ABORT=3]="ABORT",e[e.COMPLETE=4]="COMPLETE"}(e.UploadEventType||(e.UploadEventType={})),function(e){e[e.RESPONSE=1]="RESPONSE",e[e.UPLOAD_PROGRESS=2]="UPLOAD_PROGRESS"}(e.ResponseObjectType||(e.ResponseObjectType={}));var i=function(){function t(t,n,r,o,s){void 0===s&&(s=null),this._ok=t,this._status=n,this._headers=r,this._response=o,this._error=s,this.type=e.ResponseObjectType.RESPONSE}return Object.defineProperty(t.prototype,"ok",{get:function(){return this._ok},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"headers",{get:function(){return this._headers},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"response",{get:function(){return this._response},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"error",{get:function(){return this._error},enumerable:!0,configurable:!0}),t}(),u=function(){function t(t,n){this.event=t,this.xhr=n,this.type=e.ResponseObjectType.UPLOAD_PROGRESS}return Object.defineProperty(t.prototype,"percent",{get:function(){return this.event.loaded/this.event.total},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"total",{get:function(){return this.event.total},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loaded",{get:function(){return this.event.loaded},enumerable:!0,configurable:!0}),t.prototype.cancel=function(){this.xhr.abort()},t}(),a=/\[object ([^\]]+)\]/,p=Object.prototype.toString,c=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),f=function(e,t,n,r){return new(n||(n=Promise))(function(o,s){function i(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,u)}a((r=r.apply(e,t||[])).next())})},h=function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,s&&(i=s[2&n[0]?"return":n[0]?"throw":"next"])&&!(i=i.call(s,n[1])).done)return i;switch(s=0,i&&(n=[0,i.value]),n[0]){case 0:case 1:i=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,s=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){a.label=n[1];break}if(6===n[0]&&a.label<i[1]){a.label=i[1],i=n;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(n);break}i[2]&&a.ops.pop(),a.trys.pop();continue}n=t.call(e,a)}catch(e){n=[6,e],s=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,s,i,u,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return u={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u},d=function(o){function s(e){var t=o.call(this,e,{request:["get","post","put","delete","upload"],response:"getResponse"})||this;return t.history=[],t}return c(s,o),Object.defineProperty(s,"maxHistoryLength",{set:function(e){this._maxHistoryLength=e},enumerable:!0,configurable:!0}),Object.defineProperty(s,"maxHistoryLenght",{get:function(){return this._maxHistoryLength},enumerable:!0,configurable:!0}),s.prototype.subscribe=function(e){var t=this,r=new n.Subscription;if(e.http){for(var o in e.http)!function(n){var o=e.http[n];r.add(o.subscribe(function(e){return t.push(n,e)}))}(o);for(var o in e.http){var s=e.http[o];(s instanceof n.ConnectableObservable||"function"==typeof s.connect)&&s.connect()}}return r},s.prototype.push=function(e,t){var n=this;if("RETRY"===e){var r=this.history[this.history.length-("number"==typeof t?t+1:1)];if(!r)return new Promise(function(e,t){return t(new Error("Invlaid retry number specified."))});e=r.key,t=r.args}else this.history.length>s._maxHistoryLength&&this.history.shift(),this.history.push({key:e,args:t});if(!t)return new Promise(function(e,t){return t(new Error("Config required."))});var o=t;o.reduce||(o.reduce=function(e){return e});var u=this.store.get(e);if(o.upload)return this.upload(o).then(function(e){n.handleUploadResonse(u,e,o)});return this.handleResponse(o,function(e,t){var r=n.processHeaders(e),s=new i(e.ok,e.status,r,e.ok?t:null,e.ok?null:t);u.forEach(function(e){return e.next(o.reduce({data:s,state:n.state}))})},function(e,t){var r=new i(!1,e&&e.status?e.status:500,{},null,t);u.forEach(function(e){return e.next(o.reduce({data:r,state:n.state}))})})},s.prototype.handleUploadResonse=function(t,n,r){var o=this,s=n.subscribe(function(n){if(n.type!==e.UploadEventType.PROGRESS){s.unsubscribe();var a=n.type!==e.UploadEventType.COMPLETE,p=n.xhr.getResponseHeader("Content-Type")||"",c=r.responseType===e.ResponseType.JSON||p.indexOf("application/json")>-1?JSON.parse(n.xhr.responseText):n.xhr.responseText,f={};n.xhr.getAllResponseHeaders().split("\n").forEach(function(e){var t=e.split(":"),n=t[0],r=t[1];n&&r&&(f[n.trim()]=r.trim())}),t.forEach(function(t){var s=new i(n.type===e.UploadEventType.COMPLETE,n.xhr.status,f,a?c:null,a?null:c);t.next(r.reduce({data:s,state:o.state}))})}else t.forEach(function(e){var t=new u(n.event,n.xhr);e.next(r.reduce({data:t,state:o.state}))})})},s.prototype.handleResponse=function(t,n,r){return f(this,void 0,void 0,function(){var o,s,i,u,a,p,c,f=this;return h(this,function(h){switch(h.label){case 0:return h.trys.push([0,4,,11]),[4,function(){switch(t.method){case e.HttpMethod.GET:return f.get(t);case e.HttpMethod.POST:return f.post(t);case e.HttpMethod.PUT:return f.put(t);case e.HttpMethod.DELETE:return f.delete(t);default:return f.get(t)}}()];case 1:if(!(o=h.sent()).ok)throw o;if(!o.url){s="url";try{o[s]=t.url}catch(e){}}return(a=this.getResponse(t.responseType,o))&&a.then?[4,a]:[3,3];case 2:i=h.sent(),n(o,i),h.label=3;case 3:return[3,11];case 4:if(!(u=h.sent())||"function"!=typeof u.json)return[3,9];if(!(a=this.getResponse(t.responseType,u))||!a.then)return[3,8];h.label=5;case 5:return h.trys.push([5,7,,8]),[4,a];case 6:return p=h.sent(),r(u,p),[3,8];case 7:return c=h.sent(),r(u,c),[3,8];case 8:return[3,10];case 9:r(u,u),h.label=10;case 10:return[3,11];case 11:return[2]}})})},s.prototype.processHeaders=function(e){var t={};return e.headers.forEach(function(e,n){return t[n]=e}),t},s.prototype.getFetcher=function(){return fetch},s.prototype.get=function(e){var t=e.url,n=e.headers,o=void 0===n?{}:n,s=e.data,i=void 0===s?null:s,u=e.mode;return this.getFetcher()(i?""+t+r(i):t,{method:"GET",headers:o,mode:u||"same-origin"})},s.prototype.post=function(e){var t=e.url,n=e.headers,o=void 0===n?{}:n,s=e.data,i=void 0===s?{}:s,u=e.json,a=void 0===u||u,p=e.form,c=void 0!==p&&p,f=e.mode;return this.getFetcher()(t,{headers:o,method:"POST",mode:f||"same-origin",body:a?JSON.stringify(i):c?r(i):i})},s.prototype.put=function(e){var t=e.url,n=e.headers,o=void 0===n?{}:n,s=e.data,i=void 0===s?{}:s,u=e.json,a=void 0===u||u,p=e.form,c=void 0!==p&&p,f=e.mode;return this.getFetcher()(t,{headers:o,method:"PUT",mode:f||"same-origin",body:a?JSON.stringify(i):c?r(i):i})},s.prototype.delete=function(e){var n=e.url,o=e.headers,s=void 0===o?{}:o,i=e.data,u=void 0===i?{}:i,a=e.json,p=void 0===a||a,c=e.form,f=void 0!==c&&c,h={headers:s,method:"DELETE",mode:e.mode||"same-origin"};return t.isDefined(u)&&(h.body=p?JSON.stringify(u):f?r(u):u),this.getFetcher()(n,h)},s.prototype.upload=function(t){var r=t.method,o=t.url,s=t.headers,i=void 0===s?{}:s,u=t.data,a=void 0===u?{}:u,p=(t.mode,new XMLHttpRequest),c=new n.Subject,f={},h=function(e,t,n,r){void 0===r&&(r=!1),f[t]=function(t){if(r)for(var o in f)e.removeEventListener(o,f[o]);n(t)},e.addEventListener(t,f[t],!1)};p.upload&&h(p.upload,"progress",function(t){return c.next({type:e.UploadEventType.PROGRESS,event:t,xhr:p})}),h(p,"error",function(t){return c.next({type:e.UploadEventType.ERROR,event:t,xhr:p})},!0),h(p,"abort",function(t){return c.next({type:e.UploadEventType.ABORT,event:t,xhr:p})},!0),h(p,"load",function(t){p.upload||c.next({type:e.UploadEventType.PROGRESS,event:{total:1,loaded:1},xhr:p}),c.next({type:e.UploadEventType.COMPLETE,event:t,xhr:p})},!0),p.open(e.HttpMethod[r],o,!0);for(var d in i)p.setRequestHeader(d,i[d]);return p.send(a),Promise.resolve(c)},s.prototype.getResponse=function(t,n){switch(t){case e.ResponseType.ARRAY_BUFFER:return n.arrayBuffer();case e.ResponseType.BLOB:return n.blob();case e.ResponseType.FORM_DATA:return n.formData();case e.ResponseType.JSON:return n.json();case e.ResponseType.TEXT:return n.text();case e.ResponseType.STREAM:return Promise.resolve(n.body);default:return n.text()}},s.prototype.getResponseTypeFromHeader=function(t){var n=t.headers.get("content-type");return n.indexOf("text/plain")>-1?e.ResponseType.TEXT:n.indexOf("text/json")>-1||n.indexOf("application/json")>-1?e.ResponseType.JSON:/^(?:image|audio|video|(?:application\/zip)|(?:application\/octet-stream))/.test(n)?e.ResponseType.BLOB:e.ResponseType.TEXT},s._maxHistoryLength=10,s}(t.StateHandler),l=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),y=function(e){function t(t,n){var r=e.call(this,n)||this;return r.methods=t,r.fetchFunction=function(e,t){return new Promise(function(n,o){setTimeout(function(){var s=r.methods[(t.method||"get").toLowerCase()];if("function"==typeof s){var i=s;try{return n(i(e,t))}catch(e){return o(e)}}n(new Response(t.body,{status:200,statusText:"OK"}))},100)})},r}return l(t,e),Object.defineProperty(t.prototype,"fetch",{get:function(){return this.fetchFunction},enumerable:!0,configurable:!0}),t}(d);e.____$_react_mvi_module_reference_bug_fix__dummy_$____=function(){},e.HttpResponseImpl=i,e.HttpUploadProgressImpl=u,e.HttpHandler=d,e.HttpHandlerMock=y}({},ReactMVI,Rx);
